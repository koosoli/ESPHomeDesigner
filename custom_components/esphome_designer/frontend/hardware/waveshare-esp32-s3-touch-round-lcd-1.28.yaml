# ============================================================================
# ESPHome YAML - Generated by ESPHome Designer
# ============================================================================
# TARGET DEVICE: Waveshare Touch Round LCD 1.28" 240x240
#         - https://www.waveshare.com/esp32-s3-touch-lcd-1.28.htm
#         - Display Platform: ili9xxx
#         - PSRAM: Yes (Octal, 80MHz)
#         - Touchscreen: CST816S (I2C)
#         - Framework: ESP-IDF with execute_from_psram
# Name: Waveshare Touch Round LCD 1.28"
# Resolution: 240x240
# Shape: round
# ============================================================================
#
# ============================================================================
#
# SETUP INSTRUCTIONS:
#
# STEP 1: Copy the Material Design Icons font file
#         - From this repo: resources/fonts/materialdesignicons-webfont.ttf
#         - To ESPHome: /config/esphome/fonts/materialdesignicons-webfont.ttf
#         (Create the fonts folder if it doesn't exist)
#
# STEP 2: Create a new device in ESPHome
#         - Click "New Device"
#         - Name: your-device-name
#         - Select: ESP32-S3
#         - Framework: ESP-IDF (Required for this device)
#
# STEP 3: PASTE this snippet into your device YAML
#         - Paste this snippet at the end of your configuration.
#         - System sections (esphome, esp32, psram, etc.) are auto-commented
#           to avoid conflicts with your existing setup.
#
# ============================================================================

substitutions:
  name: "waveshare-esp32s3-round-lcd-128"
  friendly_name: "Waveshare Touch Round LCD 1.28\""
  device_description: "Waveshare ESP32-S3 Touch Round LCD 1.28 inch"
  project_name: "karl-petter.ESPHomeDesigner_Waveshare_Touch_Round_LCD_1_28"
  project_version: "1.0.0"
  #GPIO pins for the LCD screen
  rstpin:  GPIO14
  dcpin:   GPIO8
  blpin:   GPIO2
  clkpin:  GPIO10
  mosipin: GPIO11
  misopin: GPIO12
  cspin:   GPIO9
  # GPIO pins for i2c
  sdapin:  GPIO6
  sclpin:  GPIO7
  # GPIO pins for the IMU QMI8658C
  imuint1pin: GPIO4
  imuint2pin: GPIO3
  # GPIO pins for Touchpanel
  tpintpin: GPIO5
  tprstpin: GPIO13
  # GPIO pins battery
  batadcpin: GPIO1
  logger: DEBUG

esphome:
  min_version: 2025.12.0
  name: "${name}"
  friendly_name: "${friendly_name}"
  project:
    name: "${project_name}"
    version: "${project_version}"

esp32:
  board: waveshare_esp32s3_touch_lcd_128
  variant: esp32s3
  flash_size: 16MB
  framework:
    type: esp-idf
    advanced:
      execute_from_psram: true
    sdkconfig_options:
      CONFIG_ESP32S3_DEFAULT_CPU_FREQ_240: "y"
      CONFIG_ESP32S3_DATA_CACHE_64KB: "y"
      CONFIG_SPIRAM_FETCH_INSTRUCTIONS: y
      CONFIG_SPIRAM_RODATA: y

psram:
  mode: octal
  speed: 80MHz

preferences:
  flash_write_interval: 5min

spi:
  mosi_pin: $mosipin
  clk_pin: $clkpin

i2c:
  sda: $sdapin
  scl: $sclpin

touchscreen:
  platform: cst816
  id: my_touchscreen
  interrupt_pin: $tpintpin
  reset_pin: $tprstpin
    
output:
  - platform: ledc
    pin: $blpin
    id: backlight_pwm

light:
  - platform: monochromatic
    output: backlight_pwm
    name: "Display Backlight"
    id: back_light
    restore_mode: RESTORE_AND_ON

display:
  - platform: ili9xxx
    model: GC9A01A
    id: my_display
    invert_colors: true
    cs_pin: $cspin
    color_order: BGR
    dimensions:
      width: 240
      height: 240
    reset_pin: $rstpin
    dc_pin: $dcpin
    # __LAMBDA_PLACEHOLDER__
