const M=(e,i,{getColorStyle:t})=>{const a=i.props||{},_=a.color||"black",r=a.icon_size||20,x=a.font_size||14,o=a.border_thickness||0;e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="space-around",e.style.padding="0 10px",e.style.boxSizing="border-box";let n=t(_);if(e.style.overflow="hidden",a.show_background){const l=t(a.background_color||"white");e.style.backgroundColor=l,e.style.borderRadius=(a.border_radius||8)+"px",o>0?e.style.border=`${o}px solid ${t(a.border_color||"white")}`:e.style.border="none",n==="#000000"&&l==="#000000"&&(n="#ffffff"),(!a.background_color||a.background_color==="transparent")&&(e.style.border="1px dashed #444")}else e.style.backgroundColor="transparent",e.style.borderRadius="0",e.style.border="none";e.style.color=n;const c=l=>{if(!window.AppState||!window.AppState.entityStates)return null;for(const f of l)if(f&&window.AppState.entityStates[f])return window.AppState.entityStates[f].state;return null},s=[];if(a.show_wifi){const l=c([a.wifi_entity,"wifi_signal_dbm","sensor.wifi_signal"]);s.push({type:"wifi",icon:"F0928",val:l!==null?Math.round(l)+"dB":"-65dB"})}if(a.show_temperature){const l=c([a.temp_entity,"sht4x_temperature","sht3x_temperature","shtc3_temperature","sensor.temperature"]);s.push({type:"temp",icon:"F050F",val:l!==null?parseFloat(l).toFixed(1)+"°C":"23.5°C"})}if(a.show_humidity){const l=c([a.hum_entity,"sht4x_humidity","shtc3_humidity","sensor.humidity"]);s.push({type:"hum",icon:"F058E",val:l!==null?Math.round(l)+"%":"45%"})}if(a.show_battery){const l=c([a.bat_entity,"battery_level","sensor.battery_level"]);s.push({type:"bat",icon:"F0079",val:l!==null?Math.round(l)+"%":"85%"})}e.innerHTML="",s.forEach(l=>{const f=document.createElement("div");f.style.display="flex",f.style.alignItems="center",f.style.gap="6px";const p=document.createElement("span"),u=parseInt(l.icon,16);p.innerText=String.fromCodePoint(u),p.style.fontFamily="'Material Design Icons', 'MDI', system-ui, -sans-serif",p.style.fontSize=r+"px",p.style.lineHeight="1";const h=document.createElement("span");h.innerText=l.val,h.style.fontSize=x+"px",h.style.fontFamily="Roboto, system-ui, -sans-serif",h.style.fontWeight="500",h.style.whiteSpace="nowrap",f.appendChild(p),f.appendChild(h),e.appendChild(f)})},U=(e,i)=>{const{lines:t,addFont:a,getColorConst:_,addDitherMask:r,getCondProps:x,getConditionCheck:o,profile:n,isEpaper:c}=i,s=e.props||{},l=parseInt(s.icon_size||20,10),f=parseInt(s.font_size||14,10),p=s.color||"white",u=_(p),h=s.show_wifi!==!1,d=s.show_temperature!==!1,b=s.show_humidity!==!1,E=s.show_battery!==!1,z=s.show_background!==!1,F=_(s.background_color||"black"),T=parseInt(s.border_radius||8,10),m=parseInt(s.border_thickness||0,10),v=_(s.border_color||"white"),C=(s.wifi_entity||"wifi_signal_dbm").replace(/[^a-zA-Z0-9_]/g,"_"),I=(s.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_"),L=(s.hum_entity||(n.features?.sht4x?"sht4x_humidity":n.features?.sht3x||n.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_"),R=(s.temp_entity||(n.features?.sht4x?"sht4x_temperature":n.features?.sht3x||n.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),N=a("Material Design Icons",400,l),g=a("Roboto",500,f);t.push(`        // widget:template_sensor_bar id:${e.id} type:template_sensor_bar x:${e.x} y:${e.y} w:${e.width} h:${e.height} wifi:${h} temp:${d} hum:${b} bat:${E} bg:${z} bg_color:${s.background_color||"black"} radius:${T} border:${m} icon_size:${l} font_size:${f} color:${p} wifi_ent:"${s.wifi_entity||""}" temp_ent:"${s.temp_entity||""}" hum_ent:"${s.hum_entity||""}" bat_ent:"${s.bat_entity||""}" ${x(e)}`);const A=o(e);A&&t.push(`        ${A}`),t.push("        {"),z?(T>0?(t.push("          auto draw_filled_rrect = [&](int x, int y, int w, int h, int r, auto c) {"),t.push("            it.filled_rectangle(x + r, y, w - 2 * r, h, c);"),t.push("            it.filled_rectangle(x, y + r, r, h - 2 * r, c);"),t.push("            it.filled_rectangle(x + w - r, y + r, r, h - 2 * r, c);"),t.push("            it.filled_circle(x + r, y + r, r, c);"),t.push("            it.filled_circle(x + w - r - 1, y + r, r, c);"),t.push("            it.filled_circle(x + r, y + h - r - 1, r, c);"),t.push("            it.filled_circle(x + w - r - 1, y + h - r - 1, r, c);"),t.push("          };"),m>0?(t.push(`          draw_filled_rrect(${e.x}, ${e.y}, ${e.width}, ${e.height}, ${T}, ${v});`),t.push(`          draw_filled_rrect(${e.x+m}, ${e.y+m}, ${e.width-2*m}, ${e.height-2*m}, ${Math.max(0,T-m)}, ${F});`)):t.push(`          draw_filled_rrect(${e.x}, ${e.y}, ${e.width}, ${e.height}, ${T}, ${F});`)):m>0?(t.push(`          it.filled_rectangle(${e.x}, ${e.y}, ${e.width}, ${e.height}, ${v});`),t.push(`          it.filled_rectangle(${e.x+m}, ${e.y+m}, ${e.width-2*m}, ${e.height-2*m}, ${F});`)):t.push(`          it.filled_rectangle(${e.x}, ${e.y}, ${e.width}, ${e.height}, ${F});`),r(t,s.border_color||"white",c,e.x,e.y,e.width,e.height),r(t,s.background_color||"black",c,e.x+m,e.y+m,e.width-2*m,e.height-2*m)):m>0&&r(t,s.border_color||"white",c,e.x,e.y,e.width,e.height);let w=0;if(h&&w++,d&&w++,b&&w++,E&&w++,w>0){const S=e.width/w;let $=e.x+S/2;const y=e.y+e.height/2;if(h&&(t.push("          {"),t.push('            const char* wifi_icon = "\\U000F092B";'),t.push(`            if (id(${C}).has_state()) {`),t.push(`              float sig = id(${C}).state;`),t.push('              if (sig >= -50) wifi_icon = "\\U000F0928";'),t.push('              else if (sig >= -70) wifi_icon = "\\U000F0925";'),t.push('              else if (sig >= -85) wifi_icon = "\\U000F0922";'),t.push('              else wifi_icon = "\\U000F091F";'),t.push("            }"),t.push(`            it.printf(${Math.round($)} - 4, ${y}, id(${N}), ${u}, TextAlign::CENTER_RIGHT, "%s", wifi_icon);`),t.push(`            if (id(${C}).has_state()) it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "%.0fdB", id(${C}).state);`),t.push(`            else it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "--dB");`),t.push("          }"),$+=S),d){const k=s.unit||"°C";t.push("          {"),t.push(`            it.printf(${Math.round($)} - 4, ${y}, id(${N}), ${u}, TextAlign::CENTER_RIGHT, "\\U000F050F");`),t.push(`            if (id(${R}).has_state() && !std::isnan(id(${R}).state)) {`),k==="°F"||k==="F"?t.push(`              it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "%.1f°F", id(${R}).state * 9.0 / 5.0 + 32.0);`):t.push(`              it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "%.1f°C", id(${R}).state);`),t.push("            } else {"),t.push(`              it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "--${k}");`),t.push("            }"),t.push("          }"),$+=S}b&&(t.push("          {"),t.push(`            it.printf(${Math.round($)} - 4, ${y}, id(${N}), ${u}, TextAlign::CENTER_RIGHT, "\\U000F058E");`),t.push(`            if (id(${L}).has_state()) it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "%.0f%%", id(${L}).state);`),t.push(`            else it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "--%%");`),t.push("          }"),$+=S),E&&(t.push("          {"),t.push('            const char* bat_icon = "\\U000F0082";'),t.push(`            float lvl = id(${I}).state;`),t.push('            if (lvl >= 90) bat_icon = "\\U000F0079";'),t.push('            else if (lvl >= 50) bat_icon = "\\U000F007E";'),t.push('            else if (lvl >= 20) bat_icon = "\\U000F007B";'),t.push('            else bat_icon = "\\U000F0083";'),t.push(`            it.printf(${Math.round($)} - 4, ${y}, id(${N}), ${u}, TextAlign::CENTER_RIGHT, "%s", bat_icon);`),t.push(`            if (id(${I}).has_state()) it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "%.0f%%", id(${I}).state);`),t.push(`            else it.printf(${Math.round($)} + 4, ${y}, id(${g}), ${u}, TextAlign::CENTER_LEFT, "--%%");`),t.push("          }"))}t.push("        }"),A&&t.push("        }")},B=e=>{const{lines:i,widgets:t,profile:a}=e,_=t.filter(o=>o.type==="template_sensor_bar");if(_.length===0)return;const r=o=>{if(!o||!o.includes(".")||o.startsWith("text_sensor.")||o.startsWith("binary_sensor.")||i.some(c=>c.includes(`entity_id: ${o}`)))return;const n=o.replace(/[^a-zA-Z0-9_]/g,"_");i.push("- platform: homeassistant"),i.push(`  id: ${n}`),i.push(`  entity_id: ${o}`),i.push("  internal: true")};if(_.forEach(o=>{const n=o.props||{};if(n.show_wifi!==!1){const c=e.mainLines||i;n.wifi_entity?r(n.wifi_entity):!c.some(s=>s.includes("id: wifi_signal_dbm"))&&!i.some(s=>s.includes("id: wifi_signal_dbm"))&&(i.push("- platform: wifi_signal"),i.push("  id: wifi_signal_dbm"),i.push("  internal: true"))}if(n.show_battery!==!1){const c=e.mainLines||i;n.bat_entity?r(n.bat_entity):!c.some(s=>s.includes("id: battery_level"))&&!i.some(s=>s.includes("id: battery_level"))&&(i.push("- platform: template"),i.push("  id: battery_level"),i.push('  name: "Battery Level"'),i.push("  unit_of_measurement: '%'"),i.push("  update_interval: 60s"),i.push("  internal: true"))}n.show_temperature!==!1&&n.temp_entity&&r(n.temp_entity),n.show_humidity!==!1&&n.hum_entity&&r(n.hum_entity)}),_.some(o=>{const n=o.props||{};return n.show_temperature!==!1&&!n.temp_entity||n.show_humidity!==!1&&!n.hum_entity})){const o=a.features?.sht4x,n=a.features?.sht3x||a.features?.sht3xd,c=o?"sht4x_sensor":n?"sht3x_sensor":"shtc3_sensor",s=o?"sht4x":n?"sht3xd":"shtcx",l=o?"sht4x_temperature":n?"sht3x_temperature":"shtc3_temperature",f=e.mainLines||i;if(!f.some(p=>p.includes(`id: ${c}`))&&!f.some(p=>p.includes(`id: ${l}`))){i.push(`- platform: ${s}`),i.push(`  id: ${c}`),(s==="sht3xd"||s==="sht4x")&&i.push("  address: 0x44"),s==="shtcx"&&(i.push("  i2c_id: bus_a"),i.push("  address: 0x70"));const p=_.some(h=>h.props?.show_temperature!==!1&&!h.props?.temp_entity),u=_.some(h=>h.props?.show_humidity!==!1&&!h.props?.hum_entity);if(p){const h=o?"sht4x_temperature":n?"sht3x_temperature":"shtc3_temperature";i.push("  temperature:"),i.push(`    id: ${h}`),i.push("    internal: true")}if(u){const h=o?"sht4x_humidity":n?"sht3x_humidity":"shtc3_humidity";i.push("  humidity:"),i.push(`    id: ${h}`),i.push("    internal: true")}i.push("  update_interval: 60s")}}},Z=(e,i)=>{const{trackIcon:t,addFont:a}=i,_=e.props||{},r=parseInt(_.icon_size||20,10),x=parseInt(_.font_size||14,10);a("Material Design Icons",400,r),a("Roboto",500,x),_.show_wifi!==!1&&["F092B","F091F","F0922","F0925","F0928"].forEach(o=>t(o,r)),_.show_temperature!==!1&&["F050F"].forEach(o=>t(o,r)),_.show_humidity!==!1&&["F058E"].forEach(o=>t(o,r)),_.show_battery!==!1&&["F0082","F0079","F007E","F007B","F0083"].forEach(o=>t(o,r))},O={id:"template_sensor_bar",name:"Sensor Bar",category:"Templates",defaults:{w:355,h:43,show_wifi:!0,show_temperature:!0,show_humidity:!0,show_battery:!0,show_background:!0,background_color:"black",border_radius:8,color:"white",font_size:14,icon_size:20},render:M,exportLVGL:(e,{common:i,convertColor:t,getLVGLFont:a,profile:_})=>{const r=e.props||{},x=t(r.color||"white"),o=parseInt(r.icon_size||20,10),n=parseInt(r.font_size||14,10),c=r.show_wifi!==!1,s=r.show_temperature!==!1,l=r.show_humidity!==!1,f=r.show_battery!==!1,p=a("Material Design Icons",o,400),u=a("Roboto",n,500),h=[];if(c){let d=`!lambda |-
`;d+=`              if (id(wifi_signal_dbm).has_state()) {
`,d+=`                float sig = id(wifi_signal_dbm).state;
`,d+=`                if (sig >= -50) return "\\U000F0928";
`,d+=`                else if (sig >= -70) return "\\U000F0925";
`,d+=`                else if (sig >= -85) return "\\U000F0922";
`,d+=`                else return "\\U000F091F";
`,d+=`              }
`,d+='              return "\\U000F092B";',h.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:d,text_font:p,text_color:x}},{label:{text:`!lambda "return id(wifi_signal_dbm).has_state() ? str_sprintf('%.0fdB', id(wifi_signal_dbm).state).c_str() : '--dB';"`,text_font:u,text_color:x,x:4}}]}})}if(s){const d=(r.temp_entity||(_.features?.sht4x?"sht4x_temperature":_.features?.sht3x||_.features?.sht3xd?"sht3x_temperature":"shtc3_temperature")).replace(/[^a-zA-Z0-9_]/g,"_"),b=r.unit||"°C";let E=`id(${d}).state`;b==="°F"&&(E=`(${d}.state * 9.0 / 5.0 + 32.0)`),h.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:'"\\U000F050F"',text_font:p,text_color:x}},{label:{text:`!lambda "return id(${d}).has_state() ? str_sprintf('%.1f${b}', ${E}).c_str() : '--${b}';"`,text_font:u,text_color:x,x:4}}]}})}if(l){const d=(r.hum_entity||(_.features?.sht4x?"sht4x_humidity":_.features?.sht3x||_.features?.sht3xd?"sht3x_humidity":"shtc3_humidity")).replace(/[^a-zA-Z0-9_]/g,"_");h.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:'"\\U000F058E"',text_font:p,text_color:x}},{label:{text:`!lambda "return id(${d}).has_state() ? str_sprintf('%.0f%%', id(${d}).state).c_str() : '--%';"`,text_font:u,text_color:x,x:4}}]}})}if(f){const d=(r.bat_entity||"battery_level").replace(/[^a-zA-Z0-9_]/g,"_");let b=`!lambda |-
`;b+=`              float lvl = id(${d}).state;
`,b+=`              if (lvl >= 90) return "\\U000F0079";
`,b+=`              else if (lvl >= 50) return "\\U000F007E";
`,b+=`              else if (lvl >= 20) return "\\U000F007B";
`,b+='              else return "\\U000F0083";',h.push({obj:{width:"SIZE_CONTENT",height:"SIZE_CONTENT",bg_opa:"TRANSP",border_width:0,layout:"FLEX",flex_flow:"ROW",flex_align_main:"CENTER",flex_align_cross:"CENTER",pad_all:0,widgets:[{label:{text:b,text_font:p,text_color:x}},{label:{text:`!lambda "return id(${d}).has_state() ? str_sprintf('%.0f%%', id(${d}).state).c_str() : '--%';"`,text_font:u,text_color:x,x:4}}]}})}return{obj:{...i,bg_color:r.show_background!==!1?t(r.background_color||"black"):"TRANSP",bg_opa:r.show_background!==!1?"COVER":"TRANSP",radius:r.border_radius||8,border_width:r.border_thickness||0,border_color:t(r.border_color||"white"),layout:{type:"FLEX",flex_flow:"ROW",flex_align_main:"SPACE_AROUND",flex_align_cross:"CENTER"},widgets:h}}},export:U,onExportNumericSensors:B,collectRequirements:Z};export{O as default};
