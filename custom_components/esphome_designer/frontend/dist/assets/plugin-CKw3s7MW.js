const k=(o,t,{getColorStyle:e})=>{const n=t.props||{},s=n.layout||"horizontal",i=Math.min(7,Math.max(1,parseInt(n.days,10)||5)),u=parseInt(n.icon_size,10)||32,l=parseInt(n.temp_font_size,10)||14,y=parseInt(n.day_font_size,10)||12,b=n.show_high_low!==!1,a=e(n.color||"black"),z=(n.font_family||"Roboto")+", sans-serif",_=[{code:"F0599",condition:"sunny"},{code:"F0595",condition:"partlycloudy"},{code:"F0597",condition:"rainy"},{code:"F0590",condition:"cloudy"},{code:"F0595",condition:"partlycloudy"}],c=["Today","Mon","Tue","Wed","Thu","Fri","Sat"],p=[{high:24,low:18},{high:20,low:14},{high:22,low:15},{high:19,low:13},{high:18,low:12},{high:21,low:15},{high:23,low:16}];if(o.innerHTML="",o.style.display="flex",o.style.flexDirection=s==="vertical"?"column":"row",o.style.alignItems="flex-start",o.style.justifyContent="flex-start",o.style.gap=s==="vertical"?"4px":"0px",o.style.overflow="hidden",o.style.padding="4px",o.style.boxSizing="border-box",o.style.backgroundColor=e(n.background_color||"transparent"),n.show_border!==!1){const r=n.border_width!==void 0?n.border_width:1,h=e(n.border_color||n.color||"black");o.style.border=`${r}px solid ${h}`}else o.style.border="none";const g=t.width-(o.style.border!=="none"?parseInt(n.border_width||1)*2:0)-8,f=t.height-(o.style.border!=="none"?parseInt(n.border_width||1)*2:0)-8,S=s==="horizontal"?Math.floor(g/i):g,F=s==="vertical"?Math.floor(f/i):f;for(let r=0;r<i;r++){const h=document.createElement("div");h.style.display="flex",h.style.flexDirection="column",h.style.alignItems="center",h.style.justifyContent="flex-start",h.style.width=`${S}px`,h.style.minHeight=s==="vertical"?`${F}px`:"auto",h.style.color=a,h.style.fontFamily=z;const m=document.createElement("div");m.style.fontSize=`${y}px`,m.style.fontWeight="400",m.style.marginBottom="2px",m.textContent=c[r]||`D${r}`,h.appendChild(m);const w=document.createElement("div"),E=_[r%_.length],I=983040+parseInt(E.code.slice(1),16);w.innerText=String.fromCodePoint(I),w.style.fontSize=`${u}px`,w.style.fontFamily="MDI, system-ui, -apple-system, BlinkMacSystemFont, sans-serif",w.style.lineHeight="1.1",h.appendChild(w);const x=document.createElement("div");x.style.fontSize=`${l}px`,x.style.fontWeight="400";const $=p[r%p.length];b?x.textContent=`${$.high}°/${$.low}°`:x.textContent=`${$.high}°`,h.appendChild(x),o.appendChild(h)}if(!t.entity_id){const r=document.createElement("div");r.style.position="absolute",r.style.bottom="2px",r.style.right="4px",r.style.fontSize="9px",r.style.color="#888",r.textContent="⚠ No weather entity",o.appendChild(r)}},N=(o,t)=>{const{lines:e,addFont:n,getColorConst:s,addDitherMask:i,sanitize:u,getCondProps:l,getConditionCheck:y,isEpaper:b}=t,a=o.props||{},z=o.entity_id||a.weather_entity||"weather.forecast_home",_=a.layout||"horizontal",c=a.show_high_low!==!1,p=parseInt(String(a.day_font_size||12),10),g=parseInt(String(a.temp_font_size||14),10),f=parseInt(String(a.icon_size||32),10),S=a.font_family||"Roboto",F=a.color||"black",r=s(F),h=n(S,700,p),m=n(S,400,g),w=n("Material Design Icons",400,f);e.push(`        // widget:weather_forecast id:${o.id} type:weather_forecast x:${o.x} y:${o.y} w:${o.width} h:${o.height} weather_entity:"${z}" layout:${_} show_high_low:${c} day_font_size:${p} temp_font_size:${g} icon_size:${f} font_family:"${S}" color:${F} ${l(o)}`);const E=y(o);E&&e.push(`        ${E}`),e.push("        {"),e.push("          static std::map<std::string, const char*> weather_icons = {"),e.push('            {"clear-night", "\\U000F0594"}, {"cloudy", "\\U000F0590"},'),e.push('            {"exceptional", "\\U000F0026"}, {"fog", "\\U000F0591"},'),e.push('            {"hail", "\\U000F0592"}, {"lightning", "\\U000F0593"},'),e.push('            {"lightning-rainy", "\\U000F067E"}, {"partlycloudy", "\\U000F0595"},'),e.push('            {"pouring", "\\U000F0596"}, {"rainy", "\\U000F0597"},'),e.push('            {"snowy", "\\U000F0598"}, {"snowy-rainy", "\\U000F067F"},'),e.push('            {"sunny", "\\U000F0599"}, {"windy", "\\U000F059D"},'),e.push('            {"windy-variant", "\\U000F059E"}'),e.push("          };"),e.push("          auto get_icon = [&](const std::string& cond_val) -> const char* {"),e.push('            return weather_icons.count(cond_val) ? weather_icons[cond_val] : "\\U000F0590";'),e.push("          };"),e.push("          auto get_day_name = [](int offset) -> std::string {"),e.push('            if (offset == 0) return "Today";'),e.push("            auto t = id(ha_time).now();"),e.push('            if (!t.is_valid()) return "---";'),e.push("            ESPTime future = ESPTime::from_epoch_local(t.timestamp + (offset * 86400));"),e.push('            char buf[8]; future.strftime(buf, sizeof(buf), "%a");'),e.push("            return std::string(buf);"),e.push("          };");const I=a.background_color||"white";if(I!=="transparent"){const d=s(I);e.push(`          it.filled_rectangle(${o.x}, ${o.y}, ${o.width}, ${o.height}, ${d});`),i(e,I,b,o.x,o.y,o.width,o.height)}if(a.show_border!==!1){const d=parseInt(a.border_width||1,10),C=a.border_color||F,T=s(C);e.push(`          for (int i = 0; i < ${d}; i++) {`),e.push(`            it.rectangle(${o.x} + i, ${o.y} + i, ${o.width} - 2 * i, ${o.height} - 2 * i, ${T});`),e.push("          }")}const $=_==="horizontal",D=$?Math.floor(o.width/5):0,M=$?0:Math.floor(o.height/5),U=Math.floor($?D/2:o.width/2);for(let d=0;d<5;d++){const C=`weather_cond_day${d}`,T=`weather_high_day${d}`,v=`weather_low_day${d}`,R=o.x+d*D,W=o.y+d*M;e.push("          {"),e.push(`            int dx = ${R}; int dy = ${W};`),e.push(`            it.printf(dx + ${U}, dy, id(${h}), ${r}, TextAlign::TOP_CENTER, "%s", get_day_name(${d}).c_str());`),e.push(`            std::string cond_day = id(${C}).state.c_str();`),e.push(`            it.printf(dx + ${U}, dy + ${p+4}, id(${w}), ${r}, TextAlign::TOP_CENTER, "%s", get_icon(cond_day));`),c&&(e.push(`            float high = id(${T}).state; float low = id(${v}).state;`),e.push("            if (!std::isnan(high) && !std::isnan(low)) {"),e.push(`              it.printf(dx + ${U}, dy + ${p+f+8}, id(${m}), ${r}, TextAlign::TOP_CENTER, "%.0f/%.0f", high, low);`),e.push("            }")),e.push("          }")}i(e,F,b,o.x,o.y,o.width,o.height),e.push("        }"),E&&e.push("        }")},P=o=>{const{lines:t,widgets:e}=o;if(e.some(s=>s.type==="weather_forecast")){t.push(""),t.push("# Weather Forecast High/Low Sensors");for(let s=0;s<5;s++)t.push("- platform: homeassistant"),t.push(`  id: weather_high_day${s}`),t.push(`  entity_id: sensor.weather_forecast_day_${s}_high`),t.push("  internal: true"),t.push("- platform: homeassistant"),t.push(`  id: weather_low_day${s}`),t.push(`  entity_id: sensor.weather_forecast_day_${s}_low`),t.push("  internal: true")}},H=o=>{const{lines:t,widgets:e}=o,n=e.filter(i=>i.type==="weather_forecast");if(n.length===0)return;const s=n[0].entity_id||n[0].props?.weather_entity||"weather.forecast_home";t.push(""),t.push("# Weather Forecast Condition Sensors");for(let i=0;i<5;i++)t.push("- platform: homeassistant"),t.push(`  id: weather_cond_day${i}`),t.push(`  entity_id: sensor.weather_forecast_day_${i}_condition`),t.push("  internal: true");t.push(""),t.push("# ============================================================================"),t.push("# HOME ASSISTANT TEMPLATE SENSORS"),t.push("# Add these template sensors to your Home Assistant configuration.yaml:"),t.push("# ============================================================================"),t.push("#"),t.push("# template:"),t.push("#   - trigger:"),t.push("#       - trigger: state"),t.push(`#         entity_id: ${s}`),t.push("#       - trigger: time_pattern"),t.push("#         hours: '/1'"),t.push("#     action:"),t.push("#       - action: weather.get_forecasts"),t.push("#         target:"),t.push(`#           entity_id: ${s}`),t.push("#         data:"),t.push("#           type: daily"),t.push("#         response_variable: forecast_data"),t.push("#     sensor:");for(let i=0;i<5;i++)t.push(`#       - name: 'Weather Forecast Day ${i} High'`),t.push(`#         unique_id: weather_forecast_day_${i}_high`),t.push("#         unit_of_measurement: '°C'"),t.push(`#         state: '{{ forecast_data["${s}"].forecast[${i}].temperature | default("N/A") }}'`),t.push(`#       - name: 'Weather Forecast Day ${i} Low'`),t.push(`#         unique_id: weather_forecast_day_${i}_low`),t.push("#         unit_of_measurement: '°C'"),t.push(`#         state: '{{ forecast_data["${s}"].forecast[${i}].templow | default("N/A") }}'`),t.push(`#       - name: 'Weather Forecast Day ${i} Condition'`),t.push(`#         unique_id: weather_forecast_day_${i}_condition`),t.push(`#         state: '{{ forecast_data["${s}"].forecast[${i}].condition | default("cloudy") }}'`);t.push("#"),t.push("# ============================================================================")},A=(o,{trackIcon:t,addFont:e})=>{const n=o.props||{},s=parseInt(n.icon_size||32,10),i=parseInt(n.day_font_size||12,10),u=parseInt(n.temp_font_size||14,10),l=n.font_family||"Roboto";e(l,700,i),e(l,400,u),e("Material Design Icons",400,s),["F0594","F0590","F0026","F0591","F0592","F0593","F067E","F0595","F0596","F0597","F0598","F067F","F0599","F059D","F059E"].forEach(y=>t(y,s))},O={id:"weather_forecast",name:"Weather Forecast",category:"Sensors",defaults:{days:5,layout:"horizontal",icon_size:32,temp_font_size:14,day_font_size:12,color:"black",font_family:"Roboto",show_high_low:!0,show_border:!1,border_width:1,border_color:"black",background_color:"white",width:370,height:90},render:k,exportLVGL:(o,{common:t,convertColor:e,getLVGLFont:n})=>{const s=o.props||{},i=5,u=(s.layout||"horizontal")==="horizontal",l=e(s.color||"black"),y=parseInt(s.day_font_size||12,10),b=parseInt(s.icon_size||32,10),a=parseInt(s.temp_font_size||14,10),z=s.show_high_low!==!1,_=[];for(let c=0;c<i;c++){const p=`!lambda |-
              if (${c} == 0) return "Today";
              auto t = id(ha_time).now();
              if (!t.is_valid()) return "---";
              ESPTime future = ESPTime::from_epoch_local(t.timestamp + (${c} * 86400));
              static char buf[16];
              future.strftime(buf, sizeof(buf), "%a");
              return buf;
            `,g=`!lambda |-
              std::string c = id(weather_cond_day${c}).state;
              if (c == "clear-night") return "\\U000F0594";
              if (c == "cloudy") return "\\U000F0590";
              if (c == "exceptional") return "\\U000F0026";
              if (c == "fog") return "\\U000F0591";
              if (c == "hail") return "\\U000F0592";
              if (c == "lightning") return "\\U000F0593";
              if (c == "lightning-rainy") return "\\U000F067E";
              if (c == "partlycloudy") return "\\U000F0595";
              if (c == "pouring") return "\\U000F0596";
              if (c == "rainy") return "\\U000F0597";
              if (c == "snowy") return "\\U000F0598";
              if (c == "snowy-rainy") return "\\U000F067F";
              if (c == "sunny") return "\\U000F0599";
              if (c == "windy") return "\\U000F059D";
              if (c == "windy-variant") return "\\U000F059E";
              return "\\U000F0590";
            `,f=[{label:{align:"TOP_MID",text:p,text_font:n(s.font_family||"Roboto",y,700),text_color:l}},{label:{align:"CENTER",y:0,text:g,text_font:n("Material Design Icons",b,400),text_color:l}},{label:{align:"BOTTOM_MID",text:z?`!lambda "return str_sprintf('%.0f/%.0f', id(weather_high_day${c}).state, id(weather_low_day${c}).state).c_str();"`:`!lambda "return str_sprintf('%.0f', id(weather_high_day${c}).state).c_str();"`,text_font:n(s.font_family||"Roboto",a,400),text_color:l}}];_.push({obj:{width:u?100/i+"%":"100%",height:u?"100%":100/i+"%",bg_opa:"TRANSP",border_width:0,widgets:f}})}return{obj:{...t,bg_color:e(s.background_color||"white"),bg_opa:"COVER",radius:8,border_width:s.show_border!==!1?s.border_width||1:0,border_color:e(s.border_color||s.color||"black"),layout:{type:"FLEX",flex_flow:u?"ROW":"COLUMN",flex_align_main:"SPACE_AROUND",flex_align_cross:"CENTER"},widgets:_}}},export:N,onExportNumericSensors:P,onExportTextSensors:H,collectRequirements:A};export{O as default};
